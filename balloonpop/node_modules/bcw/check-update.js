const updateNotifier = require("update-notifier");
const pkg = require("./package.json");
const inquirer = require("inquirer");

//prompts and the name of properties added to the answers object
const prompts = [
  {
    name: "update",
    type: "list",
    message:
      "You are using a older version of this tool we recommend updating before you continue, Update Now?",
    choices: ["Yes", "No"]
  }
];
module.exports = async function update() {
  await new Promise((resolve, reject) => {
    updateNotifier({
      pkg,
      updateCheckInterval: 0,
      async callback(err, info) {
        if (err) {
          console.error(err);
          return reject(err)
        }
        if (info.current != info.latest) {
          let choice = await inquirer.prompt(prompts);
          if (choice.update == "Yes") {
            var exec = require("child_process");
            exec.execSync("npm i -g bcw");
          }
        }
        resolve()
      }
    });
  })
}

